esphomeyaml:
  name: controller_1
  platform: ESP8266
  board: d1_mini

wifi:
  ssid: 'ssid'
  password: 'password'

mqtt:
  broker: '192.168.42.1'
  port: 1883
  # username: '<mqtt_user>'
  # password: '<mqtt_password>'
  # Start all MQTT published topics with the following prefix, make sure there is no trailing /
  topic_prefix: 'devices/controller_1'



# Status LED, the built-in LED is on D4
status_led:
  pin:
    number: D4
    inverted: False

# Enable logging
logger:

ota:
  password: 'PWN'

web_server:
  port: 80

sensor:
  - platform: uptime
    name: Uptime Sensor

  # Wifi is a builtin sensor
  - platform: wifi_signal
    name: "WiFi Signal Sensor"
    update_interval: 10s

  # The HC-SR04 sensor by uses two pins, 
  # Every 1 second a new sample is taken
  - platform: ultrasonic
    trigger_pin: D6
    echo_pin: D7
    update_interval: 1s
    name: "Distance"
    filters:
      - filter_nan:
#      - sliding_window_moving_average:
#          window_size: 5
#          send_every: 1
      - lambda: |-
          return 100 - ((x - 10) / (55 - 10) * 100);
#          return (x / 10000.0) * 2000000.0;
      - unique:
switch:
  - platform: gpio
    pin:
      number: D1
      inverted: yes
    id: relay
    restore_mode: ALWAYS_OFF
  - platform: gpio
    pin:
      number: D2
      inverted: yes
    id: valve
    restore_mode: ALWAYS_OFF
  - platform: restart
    name: "Restart"



